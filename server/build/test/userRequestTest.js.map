{"version":3,"sources":["../../src/test/userRequestTest.js"],"names":["server","Server","app","expressServer","expect","chai","use","chaiHttp","signedInUser","createdRequest1","createdRequest2","request4","category","description","urgent","address","userId","status","describe","it","request","post","send","username","regularUser1","password","then","res","Object","assign","body","to","have","be","an","property","token","a","get","set","eql","message","request1","adminId","adminUser","id","equal","any","keys","request2","request3","userid","regularUser2","length","of","at","least","adminid","put","delete"],"mappings":"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","file":"userRequestTest.js","sourcesContent":["import chai from 'chai';\r\nimport chaiHttp from 'chai-http';\r\nimport Server from './../app';\r\nimport { regularUser1, regularUser2, adminUser } from './signupTest';\r\n\r\nconst server = new Server();\r\nconst app = server.expressServer();\r\nconst { expect } = chai;\r\nchai.use(chaiHttp);\r\nconst signedInUser = {};\r\nconst createdRequest1 = {};\r\nconst createdRequest2 = {};\r\n\r\nconst request4 = {\r\n  category: 'electrical',\r\n  description: '',\r\n  urgent: true,\r\n  address: 'somewhere in the world',\r\n  userId: 2,\r\n  status: 'awaiting confirmation',\r\n};\r\n\r\nexport default describe('Users controller', () => {\r\n  it('should signin a User in and give a token', () => {\r\n    return chai.request(app)\r\n      .post('/api/v1/auth/signin')\r\n      .send({\r\n        username: regularUser1.username,\r\n        password: '123456',\r\n      })\r\n      .then((res) => {\r\n        Object.assign(signedInUser, res.body);\r\n        expect(res).to.have.status(200);\r\n        expect(res.body).to.be.an('Object');\r\n        expect(res.body).to.have.property('token');\r\n        expect(res.body.token).to.be.a('string');\r\n      });\r\n  });\r\n\r\n  describe('Empty request model', () => {\r\n    it('should return an empty array', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n        });\r\n    });\r\n\r\n    it('should return not found for the request id that does not exist', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests/1')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(404);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'request not found' });\r\n        });\r\n    });\r\n  });\r\n\r\n  describe('Create requests', () => {\r\n    it('should create a new request', () => {\r\n      const request1 = {\r\n        category: 'electrical',\r\n        description: 'Socket burned',\r\n        urgent: true,\r\n        address: 'somewhere in the world',\r\n        adminId: adminUser.id,\r\n      };\r\n      return chai.request(app)\r\n        .post('/api/v1/users/requests')\r\n        .set('token', signedInUser.token)\r\n        .send(request1)\r\n        .then((res) => {\r\n          Object.assign(createdRequest1, res.body);\r\n          expect(res).to.have.status(201);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body.id).to.equal(1);\r\n          expect(res.body).to.have.any.keys(['description', 'category', 'userId']);\r\n        });\r\n    });\r\n\r\n    it('should create a new request', () => {\r\n      const request2 = {\r\n        category: 'electrical',\r\n        description: 'Socket burned',\r\n        urgent: true,\r\n        address: 'somewhere in the world',\r\n        adminId: adminUser.id,\r\n      };\r\n      return chai.request(app)\r\n        .post('/api/v1/users/requests')\r\n        .set('token', signedInUser.token)\r\n        .send(request2)\r\n        .then((res) => {\r\n          Object.assign(createdRequest2, res.body);\r\n          expect(res).to.have.status(201);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body.id).to.equal(2);\r\n          expect(res.body).to.have.any.keys('description');\r\n          expect(res.body).to.have.any.keys('category');\r\n          expect(res.body).to.have.any.keys('userid');\r\n          expect(res.body).to.have.any.keys('adminid');\r\n        });\r\n    });\r\n    it('should not create request for users that does not exist', () => {\r\n      const request3 = {\r\n        category: 'electrical',\r\n        description: 'Socket burned',\r\n        urgent: true,\r\n        address: 'somewhere in the world',\r\n        userid: 9,\r\n      };\r\n      return chai.request(app)\r\n        .post('/api/v1/users/requests')\r\n        .set('token', signedInUser.token)\r\n        .send(request3)\r\n        .then((res) => {\r\n          expect(res).to.have.status(400);\r\n          expect(res.body).to.be.an('object');\r\n        });\r\n    });\r\n\r\n    it('should not create request if a required field is not present', () => {\r\n      return chai.request(app)\r\n        .post('/api/v1/users/requests')\r\n        .set('token', signedInUser.token)\r\n        .send(request4)\r\n        .then((res) => {\r\n          expect(res).to.have.status(400);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'missing required field' });\r\n        });\r\n    });\r\n  });\r\n\r\n  // test for get ../users/requests/:requestId\r\n  describe('get one request', () => {\r\n    it('should return a request with the given id for a logged in user', () => {\r\n      const { id } = createdRequest1;\r\n      return chai.request(app)\r\n        .get(`/api/v1/users/requests/${id}`)\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body.request).to.have.any.keys('userid');\r\n        });\r\n    });\r\n\r\n    it('should return not found for requestId that does not exist for a logged in user', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests/20')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(404);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'request not found' });\r\n        });\r\n    });\r\n\r\n    it('should return not found for the requestId with no matching userId', () => {\r\n      const { id } = createdRequest1;\r\n      return chai.request(app)\r\n        .get(`/api/v1/users/requests/${id}`)\r\n        .set('token', regularUser2.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(404);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'request not found' });\r\n        });\r\n    });\r\n\r\n    it('should return bad request if requestId is invalid', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests/0')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(400);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'missing required field' });\r\n        });\r\n    });\r\n\r\n    it('should return bad request if neither userId nor requestId is valid', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests/0')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(400);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'missing required field' });\r\n        });\r\n    });\r\n  });\r\n\r\n  // test for get ../users/requests\r\n  describe('get all request', () => {\r\n    it('should return all request for logged in user', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n          expect(res.body).to.be.an('array');\r\n          expect(res.body).to.have.length.of.at.least(1);\r\n          // expect(res.body[0].request).to.deep.include.members([createdRequest1]);\r\n        });\r\n    });\r\n\r\n    it('should return an empty array if no matching userId is found', () => {\r\n      return chai.request(app)\r\n        .get('/api/v1/users/requests')\r\n        .set('token', regularUser2.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n          expect(res.body).to.be.an('array');\r\n          expect(res.body.length).to.equal(0);\r\n        });\r\n    });\r\n  });\r\n\r\n  describe('Users request update', () => {\r\n    it('users should be able to modify the other field except the status of a request', () => {\r\n      const { id, adminid } = createdRequest1;\r\n      return chai.request(app)\r\n        .put(`/api/v1/users/requests/${id}`)\r\n        .set('token', signedInUser.token)\r\n        .send({\r\n          adminId: adminid,\r\n          description: 'wall socket got burned and need replacement',\r\n        })\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body.description).to.equal('wall socket got burned and need replacement');\r\n        });\r\n    });\r\n\r\n    it('users should not be able to modify the status of a request', () => {\r\n      const { id, adminid } = createdRequest1;\r\n      return chai.request(app)\r\n        .put(`/api/v1/users/requests/${id}`)\r\n        .set('token', signedInUser.token)\r\n        .send({\r\n          adminId: adminid,\r\n          status: 'approved',\r\n        })\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body.status).to.equal('awaiting confirmation');\r\n        });\r\n    });\r\n\r\n    it('should return not found for a request that does not exist', () => {\r\n      const { adminid } = createdRequest1;\r\n      return chai.request(app)\r\n        .put('/api/v1/users/requests/20')\r\n        .set('token', signedInUser.token)\r\n        .send({\r\n          adminId: adminid,\r\n          description: 'wall socket got burned and need replacement',\r\n        })\r\n        .then((res) => {\r\n          expect(res).to.have.status(404);\r\n          expect(res.body).to.be.an('object');\r\n        });\r\n    });\r\n\r\n    it('should return not found for a request if userId does not match', () => {\r\n      const { id, adminid } = createdRequest1;\r\n      return chai.request(app)\r\n        .put(`/api/v1/users/requests/${id}`)\r\n        .set('token', regularUser2.token)\r\n        .send({\r\n          adminId: adminid,\r\n          description: 'wall socket got burned and need replacement',\r\n        })\r\n        .then((res) => {\r\n          expect(res).to.have.status(404);\r\n          expect(res.body).to.be.an('object');\r\n        });\r\n    });\r\n  });\r\n\r\n  // test for delete ../users/requests/:requestId\r\n  describe('delete request', () => {\r\n    it('should delete a request', () => {\r\n      const { id } = createdRequest2;\r\n      return chai.request(app)\r\n        .delete(`/api/v1/users/requests/${id}`)\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(200);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'request has been deleted' });\r\n        });\r\n    });\r\n\r\n    it('should return not found for a request that does not exist', () => {\r\n      return chai.request(app)\r\n        .delete('/api/v1/users/requests/15')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(404);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'request not found, not action taken' });\r\n        });\r\n    });\r\n\r\n    it('should return bad request if requestId is not specified params', () => {\r\n      return chai.request(app)\r\n        .delete('/api/v1/users/requests/0')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(400);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'missing required field' });\r\n        });\r\n    });\r\n\r\n    it('should return bad request if requestId and userId is invalid', () => {\r\n      return chai.request(app)\r\n        .delete('/api/v1/users/requests/0')\r\n        .set('token', signedInUser.token)\r\n        .then((res) => {\r\n          expect(res).to.have.status(400);\r\n          expect(res.body).to.be.an('object');\r\n          expect(res.body).to.eql({ message: 'missing required field' });\r\n        });\r\n    });\r\n  });\r\n});\r\n\r\nexport {\r\n  createdRequest1,\r\n  createdRequest2,\r\n};\r\n"]}